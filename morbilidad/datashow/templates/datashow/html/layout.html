<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - My Django Application</title>
    {% load staticfiles %}
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/bootstrap.min.css' %}" />
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/site.css' %}" />
    <script src="{% static 'app/scripts/modernizr-2.6.2.js' %}"></script>
       
    <script>
        // Este script genera el grafico 
        function init(){ //No estoy seguro si init() es necesaria, la llamo en el body onload="init();" para asegurar que el script se ejecuta
            $(function () {

                // En el primer parametro va el Json, actualmente jala datos de una web
                $.getJSON('https://www.highcharts.com/samples/data/jsonp.php?filename=analytics.csv&callback=?', function (archivo) {

                    $('#container').highcharts({

                        data: {
                            csv: archivo
                        },

                        title: {
                            text: 'Morbilidad en El Salvador'
                        },

                        subtitle: {
                            text: 'Extrapolacion'
                        },

                        xAxis: {
                            tickInterval: 7 * 24 * 3600 * 1000, // one week
                            tickWidth: 0,
                            gridLineWidth: 1,
                            labels: {
                                align: 'left',
                                x: 3,
                                y: -3
                            }
                        },

                        yAxis: [{ // left y axis
                            title: {
                                text: null
                            },
                            labels: {
                                align: 'left',
                                x: 3,
                                y: 16,
                                format: '{value:.,0f}'
                            },
                            showFirstLabel: false
                        }, { // right y axis
                            linkedTo: 0,
                            gridLineWidth: 0,
                            opposite: true,
                            title: {
                                text: null
                            },
                            labels: {
                                align: 'right',
                                x: -3,
                                y: 16,
                                format: '{value:.,0f}'
                            },
                            showFirstLabel: false
                        }],

                        legend: {
                            align: 'left',
                            verticalAlign: 'top',
                            y: 20,
                            floating: true,
                            borderWidth: 0
                        },

                        tooltip: {
                            shared: true,
                            crosshairs: true
                        },

                        plotOptions: {
                            series: {
                                cursor: 'pointer',
                                point: {
                                    events: {
                                        click: function (e) {
                                            hs.htmlExpand(null, {
                                                pageOrigin: {
                                                    x: e.pageX || e.clientX,
                                                    y: e.pageY || e.clientY
                                                },
                                                headingText: this.series.name,
                                                maincontentText: Highcharts.data('%A, %b %e, %Y', this.x) + ':<br/> ' +
                                                    this.y + ' visits', //No existen secciones para texto excepto para titulo y subtitulo
                                                width: 500              //Los otros parecen venir de la data.
                                            });
                                        }
                                    }
                                },
                                marker: {
                                    lineWidth: 1
                                }
                            }
                        },

                        series: [{
                            name: 'All visits',
                            lineWidth: 4,
                            marker: {
                                radius: 4
                            }
                        }, {
                            name: 'Future',
                           
                        }]
                    });
                });

            });
        }
    </script>

</head>

<body onload="init();">

    <script src="{% static 'app/scripts/jquery.min.js' %}"></script>
    <script src="{% static 'app/scripts/highcharts.js' %}"></script>
    <script src="{% static 'app/scripts/data.js' %}"></script>
    <script src="{% static 'app/scripts/exporting.js' %}"></script>
         

<!-- Additional files for the Highslide popup effect -->
    <script src="{% static 'app/scripts/highslide-full.min.js' %}"></script>
    <script src="{% static 'app/scripts/highslide.config.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'app/content/highslide.css' %}" />

    <!-- Esta linea llama al container -->
    <div id="container" style="min-width: 310px; height: 400px; margin: 0 auto">Grafico</div>

    <div class="navbar navbar-inverse navbar-fixed-top">
        
    </div>

    <div class="container body-content">
     <table id="alldata" width="900" border="1" align="center" >
               <tr> 
                  <th width="294" >Enfermedad</th>
                  <th width="172">Masculino</th>
                  <th width="172">Femenino</th>
                  <th width="93" >Total</th>
                  <th width="93" >Mes</th>
                  <th width="93" >Agno</th>
               </tr>
                  {% if lista_consultas %}
                  {% for consulta in lista_consultas %}
                <tr>
                  <td width="294"> {{consulta.enfermedad}}</td>
                  <td width="172">{{consulta.masculino}} </td>
                  <td width="172"> {{consulta.femenino}}</td>
                  <td width="93" > {{consulta.subtotal}}</td>
                  <td width="93" > {{consulta.mes}}</td>
                  <td width="93" >{{consulta.ano}}</td>
                </tr>
                  {% endfor %}
                {% else %}
                {% endif %}
              </table>      
</div>

    <script src="{% static 'app/scripts/bootstrap.js' %}"></script>
    <script src="{% static 'app/scripts/respond.js' %}"></script>
{% block scripts %}{% endblock %}

</body>
</html>
